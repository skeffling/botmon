# Apache Bot Monitor Configuration
# Save as: /etc/bot_monitor.conf or ~/.bot_monitor.conf

[daemon]
# Unix socket path for client connections
socket_path = /var/run/bot_monitor.sock

# Or use TCP socket (comment out socket_path and uncomment these)
# host = 127.0.0.1
# port = 9999

# PID file location
pid_file = /var/run/bot_monitor.pid

[logs]
# Apache access log file to monitor
log_file = /var/log/apache2/access.log

# Number of lines to load on startup (0 = all)
tail_lines = 10000

# Check for log rotation every N seconds
rotation_check_interval = 60

[bot_detection]
# Bot database URL
database_url = https://raw.githubusercontent.com/monperrus/crawler-user-agents/refs/heads/master/crawler-user-agents.json

# Cache file location
cache_file = ~/.bot_monitor_cache.json

# Update database every N hours (0 = never, only use cache)
update_interval = 24

[attack_detection]
# Enable bot attack detection
enabled = true

# QPS threshold - alert when bot exceeds this
qps_threshold = 10

# Time window in seconds to measure QPS
time_window = 60

# Minimum duration in seconds to be considered an attack
min_duration = 30

# Cooldown period in seconds before same bot can trigger again
cooldown = 300

[alerting]
# Enable email alerts
enabled = true

# Email settings
smtp_host = localhost
smtp_port = 25
from_address = bot-monitor@localhost
to_addresses = admin@localhost,security@localhost

# Alert message template
subject = [Bot Monitor] Attack detected from {bot_name}

[storage]
# Keep bot tracking data for N days
retention_days = 30

# Maximum attack history entries to keep
max_attack_history = 1000

# Save state on shutdown (for restart recovery)
save_state = true
state_file = /var/lib/bot_monitor/state.json

[spamhaus]
# Optional: Spamhaus DQS API key for IP reputation checks
# Get a free key at: https://www.spamhaus.com/dqs/
# Leave empty to skip Spamhaus checks
api_key =
